---
title: Microsoft Entra ID
description: How to set up Microsoft Entra ID as an OAuth provider with gau.
---

import Aside from 'starlight-plugin-icons/components/Aside.astro'

### Resources

- [Microsoft Entra ID Docs](https://learn.microsoft.com/en-us/entra/identity-platform/v2-protocols-oidc)
- [Microsoft Entra admin center](https://entra.microsoft.com/)

### Environment variables

```text title=".env"
MICROSOFT_CLIENT_ID=
MICROSOFT_CLIENT_SECRET=
```

### Callback URL

Under your app registration's "Authentication" settings, you need to add a "Web" platform and configure the redirect URI.

```
/api/auth/microsoft/callback
```

Microsoft allows adding multiple redirect URIs, so add both your development and production URLs.

### Config

The `openid`, `profile`, `email`, and `User.Read` scopes are requested by default.

<Aside type="note">
  If you plan to accept work and school accounts too, make sure to request the `verified_primary_email` optional claim. It's under your app registration's "Token configuration" settings.
</Aside>

```ts title="auth.ts"
import process from 'node:process'
import { createAuth } from '@rttnd/gau/core'
import { Microsoft } from '@rttnd/gau/oauth'

export const auth = createAuth({
  providers: [
    Microsoft({
      clientId: process.env.MICROSOFT_CLIENT_ID,
      clientSecret: process.env.MICROSOFT_CLIENT_SECRET,
    }),
  ],
})
```

### Provider params

#### tenant

> Type: `'common' | 'organizations' | 'consumers' | (string & {})`
>
> Default: `'common'`

The tenant segment used in the authorize and token endpoints.
You can also pass a specific tenant ID.

- `"consumers"` is personal accounts only.
- `"organizations"` is work/school accounts only.
- `"common"` works with both.

#### prompt

> Type: `'login' | 'none' | 'consent' | 'select_account' | (string & {})`

Optional prompt behavior to request at Microsoft.

#### params

> Type: `Record<string, string>`

Extra query params appended to the authorization URL.
